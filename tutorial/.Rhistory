getwd()
library(doBy)
library(igraph)
library(here)
setwd(here("tutorial"))
bulk_noise <- readRDS('data/bulk.rds')
gen_zscores <- readRDS('data/gen_zscores.rds')
de_zscores <- readRDS('data/de_zscores.rds')
library(doBy)
library(igraph)
library(here)
setwd(here("tutorial"))
# Load files
bulk_noise <- readRDS('data/bulk.rds')
gen_df <- readRDS('data/gen_df.rds')
de_df <- readRDS('data/de_df.rds')
# Load files
bulk <- readRDS('data/bulk.rds')
bulk <- readRDS('data/bulk.rds')
gen_df <- readRDS('data/gen_df.rds')
rownames(gen_df) <- gen_df$ensembl
de_df <- readRDS('data/de_df.rds')
rownames(de_df) <- de_df$ensembl
gen_pvals <- gen_df$pvals
de_pvals <- de_df$pvals
gen_pvals
bulk <- readRDS('data/bulk.rds')
gen_df <- readRDS('data/gen_df.rds')
de_df <- readRDS('data/de_df.rds')
gen_pvals <- gen_df$pvals
rownames(gen_pvals) <- gen_df$ensembl
# Load files
bulk <- readRDS('data/bulk.rds')
gen_df <- readRDS('data/gen_df.rds')
de_df <- readRDS('data/de_df.rds')
gen_pvals <- gen_df$pvals
rownames(gen_pvals) <- gen_df$ensembl
gen_pvals
bulk <- readRDS('data/bulk.rds')
gen_df <- readRDS('data/gen_df.rds')
de_df <- readRDS('data/de_df.rds')
gen_pvals <- gen_df$pvals
names(gen_pvals) <- gen_df$ensembl
de_pvals <- de_df$pvals
names(de_pvals) <- de_pvals$ensembl
names(de_pvals) <- de_df$ensembl
de_pvals
quantile(gen_pvals, 0.1)
gen_pvals < quantile(gen_pvals, 0.1)
gen_pvals[gen_pvals < quantile(gen_pvals, 0.1)]
names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.1)])
names(de_pvals[de_pvals < quantile(de_pvals, 0.1)])
unique(c(names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.1)]),
names(de_pvals[de_pvals < quantile(de_pvals, 0.1)])))
length(unique(c(names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.1)]),
names(de_pvals[de_pvals < quantile(de_pvals, 0.1)]))))
getwd()
best.lambda <- 0.2
pnsgraph <- construct_graph(bulk, gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
sapply(paste0(here(), '/mycode/', list.files(paste0(here(), '/mycode/'))), source)
here()
best.lambda <- 0.2
pnsgraph <- construct_graph(bulk, gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
dim(bulk)
best.lambda <- 0.2
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
screen_genes <- unique(c(names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.1)]),
names(de_pvals[de_pvals < quantile(de_pvals, 0.1)])))
best.lambda <- 0.2
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
screen_genes <- unique(c(names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.25)]),
names(de_pvals[de_pvals < quantile(de_pvals, 0.25)])))
best.lambda <- 0.2
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
screen_genes <- unique(c(names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.5)]),
names(de_pvals[de_pvals < quantile(de_pvals, 0.5)])))
best.lambda <- 0.2
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
pnsgraph$graphfinal
dim(pnsgraph$graphfinal)
best.lambda <- 0.2
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = 0.5, corthresh = 0.5, pvalscreen = NULL,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
best.lambda <- 0.1
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = 0.5, corthresh = 0.5, pvalscreen = NULL,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
pnsgraph$graphfinal
best.lambda <- 0.05
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = 0.5, corthresh = 0.5, pvalscreen = NULL,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
pnsgraph$graphfinal
screen_genes <- unique(c(names(gen_pvals[gen_pvals < quantile(gen_pvals, 0.5)]),
names(de_pvals[de_pvals < quantile(de_pvals, 0.5)])))
best.lambda <- 0.05
pnsgraph <- construct_graph(t(bulk), gen_pvals, pvalthresh = NULL, corthresh = 0.5, pvalscreen = screen_genes,
lambda = best.lambda, savefile=paste0('outputs/pns_lambda',best.lambda, '.rds'), standardize=T, verbose=T)
pnsgraph$graphfinal
